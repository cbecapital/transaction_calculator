<html lang="en"> 
<head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Transaction Fee Calculator</title> 
  <link rel="stylesheet" href="treasury.css">
</head> 
<body>     

<video autoplay muted loop id="bg-video">
  <source src="cbe-logo-2.mp4" type="video/mp4">
</video>

    <button class="home-btn" onclick="location.href='index.html'">Home</button>

<div class="container"> 
<div class="ticker">
  <div class="ticker-label">Closing Prices:</div>
  <div class="ticker-content">
    <span>WGBX: 1991</span>
    <span>GDAB: 1057</span>
    <span>TBL182: 4700</span>
    <span>QNT9: 842</span>
    <span>XYZ: 1200</span>
    <span>ABC: 340</span>

    <!-- duplicate for smooth infinite loop -->
    <span>WGBX: 1991</span>
    <span>GDAB: 1057</span>
    <span>TBL182: 4700</span>
    <span>QNT9: 842</span>
    <span>XYZ: 1200</span>
    <span>ABC: 340</span>
  </div>
</div>










<div> </div>
<div> </div>


  <button onclick="toggleCalendar()" id="calendarToggleBtn">Show Auction Calendar</button>

<div id="calendarWrapper" style="display:none; margin-top:20px;">
  <h2>T-Bill Auction Calendar</h2>
  <div class="calendar-container">
    <div class="calendar-header">
      <button onclick="prevMonth()">â¬… Prev</button>
      <h1 id="monthYear"></h1>
      <button onclick="nextMonth()">Next âž¡</button>
    </div>
    <div id="calendar" class="calendar"></div>
  </div>
</div>


  <div id="popup" class="popup">
    <h3>Auction Summary</h3>
    <table>
      <thead>
        <tr>
          <th> </th>
          <th>1 Month</th>
          <th>3 Months</th>
          <th>6 Months</th>
          <th>1 Year</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Auction Amount</td>
          <td>4B</td>
          <td>8B</td>
          <td>12B</td>
          <td>22B</td>
        </tr>
        <tr>
          <td>Face Value</td>
          <td>4.7k</td>
          <td>4.7k</td>
          <td>5k</td>
          <td>5k</td>
        </tr>
        <tr>
          <td>% Rate</td>
          <td>11%</td>
          <td>12%</td>
          <td>15%</td>
          <td>15%</td>
        </tr>
      </tbody>
    </table>
    <p>For full details and current schedules, visit the <a href="https://nbe.gov.et/treasury-bills/" target="_blank">National Bank of Ethiopia: Treasury Bills</a>.</p>

    <button onclick="closePopup()">Close</button>
    
  </div>

  
<script>
  function toggleCalendar() {
  const wrapper = document.getElementById("calendarWrapper");
  const btn = document.getElementById("calendarToggleBtn");

  if (wrapper.style.display === "none") {
    wrapper.style.display = "block";
    btn.innerText = "Hide Auction Calendar";
  } else {
    wrapper.style.display = "none";
    btn.innerText = "Show Auction Calendar";
  }
}

let currentDate = new Date();
let auctionDays = [];

function generateAuctionDays() {
  let start = new Date("2025-09-03"); // base auction
  let end = new Date();
  end.setFullYear(end.getFullYear() + 5);

  let d = new Date(start);
  while (d <= end) {
    auctionDays.push(new Date(d).toDateString());
    d.setDate(d.getDate() + 14);
  }
}

function generateCalendar(date) {
  const calendar = document.getElementById("calendar");
  const monthYear = document.getElementById("monthYear");

  calendar.innerHTML = "";

  const year = date.getFullYear();
  const month = date.getMonth();

  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);

  monthYear.innerText = `${firstDay.toLocaleString("default", { month: "long" })} ${year}`;

  // Weekday headers
  const daysOfWeek = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
  daysOfWeek.forEach(d => {
    const div = document.createElement("div");
    div.classList.add("day-name");
    div.innerText = d;
    calendar.appendChild(div);
  });

  // Blank spaces before month start
  for (let i = 0; i < firstDay.getDay(); i++) {
    calendar.appendChild(document.createElement("div"));
  }

  // Days
  for (let d = 1; d <= lastDay.getDate(); d++) {
    let dayDiv = document.createElement("div");
    dayDiv.classList.add("day");
    let fullDate = new Date(year, month, d);

    dayDiv.innerText = d;

    if (auctionDays.includes(fullDate.toDateString())) {
      dayDiv.classList.add("auction-day");
      dayDiv.onclick = () => openPopup(fullDate.toDateString());
    }

    calendar.appendChild(dayDiv);
  }
}

function prevMonth() {
  currentDate.setMonth(currentDate.getMonth() - 1);
  generateCalendar(currentDate);
}

function nextMonth() {
  currentDate.setMonth(currentDate.getMonth() + 1);
  generateCalendar(currentDate);
}

function openPopup(date) {
  document.getElementById("popup").style.display = "block";
}

function closePopup() {
  document.getElementById("popup").style.display = "none";
}

// Initialize
generateAuctionDays();
generateCalendar(currentDate);
</script>










  <h1>Transaction Fee Calculator For Treasury Bill</h1>

  <div class="button-row">
    <button class="btn" onclick="showSection('buySection')">Buy</button>
    <button class="btn" onclick="showSection('sellSection')">Sell</button>
  </div>



  <!-- BUY SECTION -->
  <div id="buySection" style="display:none; margin-top:20px;">
    <h2>Buy Transaction</h2>
    <label for="buyQuantity">Enter Quantity of Treasury (number of securities):</label>
    <input type="text" id="buyQuantity" placeholder="e.g. 100">

    <label for="buyMarketPrice"> Price (per security):</label>
    <input type="text" id="buyMarketPrice" placeholder="e.g. 120.50">

    <button onclick="calculateFee('buy')">Calculate Buy</button>
    <div id="buyResult"></div>
  </div>

  <!-- SELL SECTION -->
  <div id="sellSection" style="display:none; margin-top:20px;">
    <h2>Sell Transaction</h2>
    <label for="sellQuantity">Enter Quantity (number of securities):</label>
    <input type="text" id="sellQuantity" placeholder="e.g. 100">

    <label for="sellMarketPrice">Enter Market / Limit Price (per security):</label>
    <input type="text" id="sellMarketPrice" placeholder="e.g. 120.50">

    <button onclick="calculateFee('sell')">Calculate Sell</button>
    <div id="sellResult"></div>
  </div>

  <script>
    function showSection(sectionId) {
      document.getElementById("buySection").style.display = "none";
      document.getElementById("sellSection").style.display = "none";
      document.getElementById(sectionId).style.display = "block";
    }

const RATE = 0.00126;

function calculateFee(type) {
  const qtyId = type === "buy" ? "buyQuantity" : "sellQuantity";
  const priceId = type === "buy" ? "buyMarketPrice" : "sellMarketPrice";
  const resultId = type === "buy" ? "buyResult" : "sellResult";

  const rawQty = document.getElementById(qtyId).value.replace(/,/g, "");
  const rawPrice = document.getElementById(priceId).value.replace(/,/g, "");

  const quantity = parseFloat(rawQty);
  const marketPrice = parseFloat(rawPrice);

  if (isNaN(quantity) || quantity <= 0) {
    alert("Please enter a valid quantity (greater than 0).");
    return;
  }
  if (isNaN(marketPrice) || marketPrice <= 0) {
    alert("Please enter a valid market/limit price (greater than 0).");
    return;
  }

  const tradeValue = quantity * marketPrice;

  // fees
  const feeCBE = tradeValue * 0.001;   // 1.6%
  const feeECMA = tradeValue * 0.00005; // 0.15%
  const feeESX = tradeValue * 0.00021;  // 0.36%
  const csdFee = 0;                    // 0%

  const fee = feeCBE + feeECMA + feeESX + csdFee;
let total;
if (type === "buy") {
  total = tradeValue + fee; // buy keeps original calculation
} else {
  total = (tradeValue - fee) // sell subtracts fee and applies multiplier
}

  const resultDiv = document.getElementById(resultId);
  resultDiv.style.display = "block";

  resultDiv.innerHTML = `
    <h4>${type === "buy" ? "Buy" : "Sell"} Calculation Result</h4>
    <table class="result-table">
      
       <tbody>
        <tr><td>Quantity</td><td>${quantity.toLocaleString("en-US")}</td></tr>
        <tr><td>Market Price (per security)</td><td>${marketPrice.toLocaleString("en-US")} ETB</td></tr>
        <tr><td>Transaction Value</td><td>${tradeValue.toLocaleString("en-US")} ETB</td></tr>
      </tbody>
      <table class="result-table">
     
      <!-- CBE CAPITAL separate table -->
<table class="result-table">
  <thead>
    <tr>
      <th>Company</th>
      <th>Commission Fee</th>
      <th>Amount (ETB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CBE CAPITAL</td>
      <td>0.1%</td>
      <td>${feeCBE.toLocaleString("en-US")}</td>
    </tr>
  </tbody>
</table>

<br>

<!-- Other fees table -->
<table class="result-table">
  <thead>
    <tr>
      <th>Company</th>
      <th>% Fee</th>
      <th>Amount (ETB)</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>ECMA</td><td>0.005%</td><td>${feeECMA.toLocaleString("en-US")}</td></tr>
    <tr><td>ESX</td><td>0.021%</td><td>${feeESX.toLocaleString("en-US")}</td></tr>
    <tr><td>CSD</td><td>0.00%</td><td>${csdFee.toFixed(2)}</td></tr>
    <tr>
      <td><strong>ðŸ“Š Total </strong></td>
      <td><strong>${(RATE * 100)}%</strong></td>

      <td><strong>${fee.toLocaleString("en-US")}</strong></td>
    </tr>
  </tbody>
</table>

    <br>

    <table class="result-table">
      <tbody>
        <table class="result-table">
  <tbody>
    <tr>
      <td>ðŸ“¦ ${type === "buy" ? "Total Due" : "Net Proceeds"}</td>
      <td><strong>${total.toLocaleString("en-US")} ETB</strong></td>
    </tr>
  </tbody>
</table>

      </tbody>
    </table>
  `;
}


  </script>
</body>
</html>
<html lang="en"> 
<head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Transaction Fee Calculator</title> 
  <link rel="stylesheet" href="equity.css">
</head> 
<body>     

<video autoplay muted loop id="bg-video">
  <source src="cbe-logo-2.mp4" type="video/mp4">
</video>

    <button class="home-btn" onclick="location.href='index.html'">Home</button>

<div class="container"> 
<div class="ticker">
  <div class="ticker-label">Closing Prices:</div>
  <div class="ticker-content">
    <span>WGBX: 1200</span>
    <span>GDAB: 1057</span>
    <span>TBL182D: 4700</span>
    <span>IBMM: 15.3973%</span>


    <!-- duplicate for smooth infinite loop -->
     <span>WGBX: 1200</span>
    <span>GDAB: 1057</span>
    <span>TBL182D: 4700</span>
    <span>IBMM: 15.3973%</span>
  </div>
</div>


<script>
function formatNumberInput(input) {
  let value = input.value.replace(/,/g, ""); // remove existing commas
  if (!isNaN(value) && value !== "") {
    input.value = Number(value).toLocaleString("en-US");
  }
}
</script>



  <h1>Transaction Fee Calculator For Equity Main & Growth Market</h1>

  <div class="button-row">
    <button class="btn" onclick="showSection('buySection')">Buy</button>
    <button class="btn" onclick="showSection('sellSection')">Sell</button>
  </div>



  <!-- BUY SECTION -->
  <div id="buySection" style="display:none; margin-top:20px;">
    <h2>Buy Transaction</h2>
    <label for="buyQuantity">Enter Quantity (number of securities):</label>
<input type="text" id="buyQuantity" placeholder="e.g. 100" 
       oninput="formatNumberInput(this)">

    <label for="buyMarketPrice"> Price (per security):</label>
<input type="text" id="buyMarketPrice" placeholder="e.g. 120.50" 
       oninput="formatNumberInput(this)">

    <button onclick="calculateFee('buy')">Calculate Buy</button>
    <div id="buyResult"></div>
  </div>

  <!-- SELL SECTION -->
  <div id="sellSection" style="display:none; margin-top:20px;">
    <h2>Sell Transaction</h2>
    <label for="sellQuantity">Enter Quantity (number of securities):</label>
<input type="text" id="sellQuantity" placeholder="e.g. 100" 
       oninput="formatNumberInput(this)">

    <label for="sellMarketPrice">Enter Market / Limit Price (per security):</label>
<input type="text" id="sellMarketPrice" placeholder="e.g. 120.50" 
       oninput="formatNumberInput(this)">
       
    <button onclick="calculateFee('sell')">Calculate Sell</button>
    <div id="sellResult"></div>
  </div>

  <script>
    function showSection(sectionId) {
      document.getElementById("buySection").style.display = "none";
      document.getElementById("sellSection").style.display = "none";
      document.getElementById(sectionId).style.display = "block";
    }

const RATE = 0.0211;

function calculateFee(type) {
  const qtyId = type === "buy" ? "buyQuantity" : "sellQuantity";
  const priceId = type === "buy" ? "buyMarketPrice" : "sellMarketPrice";
  const resultId = type === "buy" ? "buyResult" : "sellResult";

  const rawQty = document.getElementById(qtyId).value.replace(/,/g, "");
  const rawPrice = document.getElementById(priceId).value.replace(/,/g, "");

  const quantity = parseFloat(rawQty);
  const marketPrice = parseFloat(rawPrice);

  if (isNaN(quantity) || quantity <= 0) {
    alert("Please enter a valid quantity (greater than 0).");
    return;
  }
  if (isNaN(marketPrice) || marketPrice <= 0) {
    alert("Please enter a valid market/limit price (greater than 0).");
    return;
  }

  const tradeValue = quantity * marketPrice;

  // fees
  const feeCBE = tradeValue * 0.016;   // 1.6%
  const feeECMA = tradeValue * 0.0015; // 0.15%
  const feeESX = tradeValue * 0.0036;  // 0.36%
  const csdFee = 0;                    // 0%

  const fee = feeCBE + feeECMA + feeESX + csdFee;
let total;
if (type === "buy") {
  total = tradeValue + fee; // buy keeps original calculation
} else {
  total = (tradeValue - fee) // sell subtracts fee and applies multiplier
}

  const resultDiv = document.getElementById(resultId);
  resultDiv.style.display = "block";

  resultDiv.innerHTML = `
    <h4>${type === "buy" ? "Buy" : "Sell"} Calculation Result</h4>
    <table class="result-table">
      
       <tbody>
        <tr><td>Quantity</td><td>${quantity.toLocaleString("en-US")}</td></tr>
        <tr><td>Market Price (per security)</td><td>${marketPrice.toLocaleString("en-US")} ETB</td></tr>
        <tr><td>Transaction Value</td><td>${tradeValue.toLocaleString("en-US")} ETB</td></tr>
      </tbody>
      <table class="result-table">
     
      <!-- CBE CAPITAL separate table -->
<table class="result-table">
  <thead>
    <tr>
      <th>Company</th>
      <th>Commission Fee</th>
      <th>Amount (ETB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CBE CAPITAL</td>
      <td>1.6%</td>
      <td>${feeCBE.toLocaleString("en-US")}</td>
    </tr>
  </tbody>
</table>

<br>

<!-- Other fees table -->
<table class="result-table">
  <thead>
    <tr>
      <th>Company</th>
      <th>% Fee</th>
      <th>Amount (ETB)</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>ECMA</td><td>0.15%</td><td>${feeECMA.toLocaleString("en-US")}</td></tr>
    <tr><td>ESX</td><td>0.36%</td><td>${feeESX.toLocaleString("en-US")}</td></tr>
    <tr><td>CSD</td><td>0.00%</td><td>${csdFee.toFixed(2)}</td></tr>
    <tr>
      <td><strong>ðŸ“Š Total </strong></td>
      <td><strong>${(RATE*100).toFixed(2)}%</strong></td>
      <td><strong>${fee.toLocaleString("en-US")}</strong></td>
    </tr>
  </tbody>
</table>

    <br>

    <table class="result-table">
      <tbody>
        <table class="result-table">
  <tbody>
    <tr>
      <td>ðŸ“¦ ${type === "buy" ? "Total Due" : "Net Proceeds"}</td>
      <td><strong>${total.toLocaleString("en-US")} ETB</strong></td>
    </tr>
  </tbody>
</table>

      </tbody>
    </table>
  `;
}


  </script>
</body>
</html>